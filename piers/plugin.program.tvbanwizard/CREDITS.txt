Many thanks Slamious and Sarge, and drinfernoo and SerpentDrago, who did the real work!